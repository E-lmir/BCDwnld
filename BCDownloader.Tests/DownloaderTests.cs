using BCDownloader.Models;

namespace BCDownloader.Tests
{
    public class DownloaderTests
    {
        [Fact]
        public async Task AlbumWith6Tracks()
        {
            var document = "<script type=\"text/javascript\" src=\"https://s4.bcbits.com/bundle/bundle/1/tralbum_head-fa1c67f7ab512a3a61510fce32341bb9.js\" crossorigin=\"anonymous\" nonce=\"YtpOC4iYJ10TTjAVm640TA==\" data-cart=\"{&quot;currency&quot;:&quot;USD&quot;,&quot;country&quot;:&quot;US&quot;,&quot;us_state&quot;:null,&quot;us_zip&quot;:null,&quot;email&quot;:null,&quot;payment_type&quot;:null,&quot;locale&quot;:&quot;en&quot;,&quot;is_default&quot;:true,&quot;country_name&quot;:&quot;United States&quot;}\" data-site=\"{&quot;supportEmail&quot;:&quot;support@mayhemindie.bandcamp.com&quot;,&quot;is_custom_domain&quot;:null,&quot;env&quot;:&quot;prod&quot;}\" data-band=\"{&quot;id&quot;:3053221293,&quot;name&quot;:&quot;MAYHEM&quot;,&quot;fan_email&quot;:null,&quot;account_id&quot;:325738685,&quot;facebook_like_enabled&quot;:1,&quot;has_discounts&quot;:false,&quot;image_id&quot;:19024851}\" data-embed=\"{&quot;tralbum_param&quot;:{&quot;name&quot;:&quot;album&quot;,&quot;value&quot;:2316086116},&quot;art_id&quot;:507955093,&quot;artist&quot;:&quot;MAYHEM&quot;,&quot;swf_base_url&quot;:&quot;https://bandcamp.com&quot;,&quot;show_campaign&quot;:null,&quot;embed_info&quot;:{&quot;public_embeddable&quot;:true,&quot;exclusive_embeddable&quot;:false,&quot;item_public&quot;:true,&quot;no_track_preorder&quot;:false},&quot;album_title&quot;:&quot;Deathcrush&quot;,&quot;linkback&quot;:&quot;https://mayhemindie.bandcamp.com/album/deathcrush&quot;}\" data-fan=\"{&quot;logged_in&quot;:false,&quot;name&quot;:null,&quot;image_id&quot;:null}\" data-band-follow-info=\"{&quot;tralbum_id&quot;:2316086116,&quot;tralbum_type&quot;:&quot;a&quot;}\" data-tralbum-collect-info=\"{&quot;show_collect&quot;:true,&quot;show_wishlist_tooltip&quot;:false}\" data-tralbum=\"{&quot;for the curious&quot;:&quot;https://bandcamp.com/help/audio_basics#steal https://bandcamp.com/terms_of_use&quot;,&quot;current&quot;:{&quot;audit&quot;:0,&quot;title&quot;:&quot;Deathcrush&quot;,&quot;new_date&quot;:&quot;19 Mar 2020 22:22:56 GMT&quot;,&quot;mod_date&quot;:&quot;08 Jun 2020 12:10:53 GMT&quot;,&quot;publish_date&quot;:&quot;19 Mar 2020 22:37:54 GMT&quot;,&quot;private&quot;:null,&quot;killed&quot;:null,&quot;download_pref&quot;:2,&quot;require_email&quot;:1,&quot;is_set_price&quot;:null,&quot;set_price&quot;:7.0,&quot;minimum_price&quot;:7.0,&quot;minimum_price_nonzero&quot;:7.0,&quot;require_email_0&quot;:1,&quot;artist&quot;:null,&quot;about&quot;:null,&quot;credits&quot;:null,&quot;auto_repriced&quot;:null,&quot;new_desc_format&quot;:1,&quot;band_id&quot;:3053221293,&quot;selling_band_id&quot;:715709424,&quot;art_id&quot;:507955093,&quot;download_desc_id&quot;:null,&quot;release_date&quot;:&quot;16 Aug 1987 00:00:00 GMT&quot;,&quot;upc&quot;:&quot;7071155278074&quot;,&quot;purchase_url&quot;:null,&quot;purchase_title&quot;:null,&quot;featured_track_id&quot;:3567238230,&quot;id&quot;:2316086116,&quot;type&quot;:&quot;album&quot;},&quot;preorder_count&quot;:null,&quot;hasAudio&quot;:true,&quot;art_id&quot;:507955093,&quot;packages&quot;:[{&quot;id&quot;:4056356959,&quot;url&quot;:&quot;https://mayhemindie.bandcamp.com/album/deathcrush&quot;,&quot;url_for_app&quot;:&quot;https://mayhemindie.bandcamp.com/album/deathcrush&quot;,&quot;type_id&quot;:1,&quot;type_name&quot;:&quot;Compact Disc (CD)&quot;,&quot;title&quot;:&quot;MAYHEM - Deathcrush CD&quot;,&quot;description&quot;:null,&quot;desc_pt1&quot;:null,&quot;desc_pt2&quot;:null,&quot;new_desc_format&quot;:1,&quot;grid_index&quot;:0,&quot;private&quot;:null,&quot;subscriber_only&quot;:null,&quot;price&quot;:10.99,&quot;is_set_price&quot;:null,&quot;is_live_ticket&quot;:null,&quot;live_event_over&quot;:null,&quot;live_event_id&quot;:null,&quot;live_event_title&quot;:null,&quot;live_event_url&quot;:null,&quot;live_event_gcal_url&quot;:null,&quot;live_event_ical_url&quot;:null,&quot;live_event_replays_enabled&quot;:null,&quot;live_event_image_color_one&quot;:null,&quot;live_event_image_color_two&quot;:null,&quot;sku&quot;:&quot;AM003CD&quot;,&quot;upc&quot;:null,&quot;band_id&quot;:3053221293,&quot;selling_band_id&quot;:715709424,&quot;label&quot;:&quot;Indie Recordings&quot;,&quot;currency&quot;:&quot;EUR&quot;,&quot;country&quot;:null,&quot;tax_rate&quot;:null,&quot;options_title&quot;:null,&quot;options&quot;:null,&quot;origins&quot;:[{&quot;id&quot;:3309706,&quot;quantity&quot;:null,&quot;quantity_sold&quot;:null,&quot;quantity_available&quot;:26,&quot;package_id&quot;:4056356959,&quot;option_id&quot;:0}],&quot;arts&quot;:[{&quot;id&quot;:857926416,&quot;file_name&quot;:&quot;2520454246&quot;,&quot;index&quot;:0,&quot;image_id&quot;:19025150,&quot;width&quot;:1300,&quot;height&quot;:1274,&quot;crc&quot;:2009942046}],&quot;album_art&quot;:null,&quot;album_art_id&quot;:507955093,&quot;shipping_exception_mode&quot;:null,&quot;download_type&quot;:&quot;a&quot;,&quot;download_id&quot;:2316086116,&quot;download_is_preorder&quot;:null,&quot;download_release_date&quot;:&quot;16 Aug 1987 00:00:00 GMT&quot;,&quot;download_title&quot;:&quot;Deathcrush&quot;,&quot;download_url&quot;:&quot;https://mayhemindie.bandcamp.com/album/deathcrush&quot;,&quot;download_has_audio&quot;:true,&quot;download_track_count&quot;:6,&quot;download_art_id&quot;:507955093,&quot;download_artist&quot;:&quot;MAYHEM&quot;,&quot;fulfillment_days&quot;:2,&quot;release_date&quot;:null,&quot;new_date&quot;:&quot;19 Mar 2020 22:37:42 GMT&quot;,&quot;edition_size&quot;:null,&quot;quantity_sold&quot;:null,&quot;quantity_available&quot;:26,&quot;quantity_limits&quot;:5,&quot;quantity_warning&quot;:false,&quot;album_id&quot;:2316086116,&quot;album_title&quot;:&quot;Deathcrush&quot;,&quot;album_artist&quot;:null,&quot;album_private&quot;:null,&quot;album_publish_date&quot;:&quot;19 Mar 2020 22:37:54 GMT&quot;,&quot;album_release_date&quot;:&quot;16 Aug 1987 00:00:00 GMT&quot;,&quot;subscriber_only_published&quot;:false,&quot;featured_date&quot;:null,&quot;certified_seller&quot;:1,&quot;limited_checkout&quot;:false,&quot;associated_license_id&quot;:null,&quot;live_event_scheduled_start_date&quot;:null,&quot;live_event_scheduled_end_date&quot;:null,&quot;live_event_start_date&quot;:null,&quot;live_event_end_date&quot;:null,&quot;live_event_timezone&quot;:null,&quot;live_event_type&quot;:null,&quot;listening_party_duration&quot;:null,&quot;is_cardable&quot;:true}],&quot;defaultPrice&quot;:7.0,&quot;freeDownloadPage&quot;:null,&quot;FREE&quot;:1,&quot;PAID&quot;:2,&quot;artist&quot;:&quot;MAYHEM&quot;,&quot;item_type&quot;:&quot;album&quot;,&quot;id&quot;:2316086116,&quot;last_subscription_item&quot;:null,&quot;has_discounts&quot;:false,&quot;is_bonus&quot;:null,&quot;play_cap_data&quot;:{&quot;streaming_limits_enabled&quot;:true,&quot;streaming_limit&quot;:3},&quot;client_id_sig&quot;:&quot;u3sGU6aidRBy3yz2YHlxVDSh/cM=&quot;,&quot;is_purchased&quot;:null,&quot;items_purchased&quot;:null,&quot;is_private_stream&quot;:null,&quot;is_band_member&quot;:null,&quot;licensed_version_ids&quot;:null,&quot;package_associated_license_id&quot;:null,&quot;has_video&quot;:null,&quot;tralbum_subscriber_only&quot;:false,&quot;featured_track_id&quot;:3567238230,&quot;initial_track_num&quot;:null,&quot;is_preorder&quot;:false,&quot;album_is_preorder&quot;:false,&quot;album_release_date&quot;:&quot;16 Aug 1987 00:00:00 GMT&quot;,&quot;trackinfo&quot;:[{&quot;id&quot;:3567238230,&quot;track_id&quot;:3567238230,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/892f1e884c8fa2e15a6bb2c299a48410/mp3-128/3567238230?p=0&amp;ts=1720455698&amp;t=f1e6e099b7d84c4f9f3bd14a3420201c229faeb4&amp;token=1720455698_b06650c88ec01e6b224b0b897fea137c3c9fdc7d&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Silvester Alfang&quot;,&quot;encodings_id&quot;:1626955524,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:1,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/silvester-alfang&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:116.813,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null},{&quot;id&quot;:1023690457,&quot;track_id&quot;:1023690457,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/ad7aca483b6e5a724404fc6c9c2e7261/mp3-128/1023690457?p=0&amp;ts=1720455698&amp;t=6b0c37f5f68c4c9043ba7df7998d0ea18e70f1fd&amp;token=1720455698_ad1f5b474b95c686a11435774ced8aef5dab8d3a&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Deathcrush&quot;,&quot;encodings_id&quot;:286517605,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:2,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/deathcrush&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:212.987,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null},{&quot;id&quot;:2060671668,&quot;track_id&quot;:2060671668,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/f4083ee9d1ff970ecd98c10197ddde2c/mp3-128/2060671668?p=0&amp;ts=1720455698&amp;t=31367ad77f6dbf56d03d1bfeae260ed65f3c4b61&amp;token=1720455698_dd2060d29b78c41400b37d3501e76b700a659a99&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Chainsaw Gutsfuck&quot;,&quot;encodings_id&quot;:2036640756,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:3,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/chainsaw-gutsfuck&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:212.76,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null},{&quot;id&quot;:701097388,&quot;track_id&quot;:701097388,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/349c0d3bd3bafd39b03a0fecce889386/mp3-128/701097388?p=0&amp;ts=1720455698&amp;t=7d0065670280b86fc8bdfff262101e95fcb6186f&amp;token=1720455698_febb554a46660190806867796944ef5a86b7feac&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Witching Hour&quot;,&quot;encodings_id&quot;:1999067953,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:4,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/witching-hour&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:109.587,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null},{&quot;id&quot;:2584364550,&quot;track_id&quot;:2584364550,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/cd1d0106e15b8dd806376371ce8bb047/mp3-128/2584364550?p=0&amp;ts=1720455698&amp;t=a80317a73cafee7e1ba32ed60ec321b1fa65fb71&amp;token=1720455698_5c2da43ae675fb4fe65ff2246e660ab1f60afaf0&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Necrolust&quot;,&quot;encodings_id&quot;:3854738927,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:5,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/necrolust&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:217.72,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null},{&quot;id&quot;:3021580316,&quot;track_id&quot;:3021580316,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/4599b7e419ffb559d7863dbec362a370/mp3-128/3021580316?p=0&amp;ts=1720455698&amp;t=f19871759d1da233204d3d4bb1c7f122d4b15d2c&amp;token=1720455698_0575afb05a836b702a4d891d102e1a0492a25866&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;(Weird) Manheim&quot;,&quot;encodings_id&quot;:155174632,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:6,&quot;album_preorder&quot;:false,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/weird-manheim&quot;,&quot;has_lyrics&quot;:false,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:177.387,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:0,&quot;is_capped&quot;:false,&quot;track_license_id&quot;:null}],&quot;playing_from&quot;:&quot;album page&quot;,&quot;url&quot;:&quot;https://mayhemindie.bandcamp.com/album/deathcrush&quot;,&quot;use_expando_lyrics&quot;:false}\" data-payment=\"{&quot;paymentType&quot;:null,&quot;paymentDownloadPage&quot;:null}\" data-referrer-token=\"&quot;424435431s0a2316086116x1720369298&quot;\"></script>";
            var customMessageHandler = new TestHttpMessageHandler(document);
            var client = new HttpClient(customMessageHandler);

            var downloader = new BCDownloader(client);
            var resp = await downloader.GetTracksInfoAsync("http://exampleurl.com");
            var tracksCount = 6;

            Assert.NotNull(resp);
            Assert.IsAssignableFrom<IEnumerable<Trackinfo>>(resp);
            Assert.All(resp, item => Assert.NotNull(item.Data));
            Assert.All(resp, item => Assert.Equal("MAYHEM", item.Artist));
            Assert.Equal(tracksCount, resp.Count());
        }

        [Fact]
        public async Task AlbumWith5TracksWith4EmptyDownloadPath()
        {
            var document = "<script type=\"text/javascript\" src=\"https://s4.bcbits.com/bundle/bundle/1/tralbum_head-fa1c67f7ab512a3a61510fce32341bb9.js\" crossorigin=\"anonymous\" nonce=\"8JZ7JFkhqOMLkceunJo4xg==\" data-cart=\"{&quot;currency&quot;:&quot;USD&quot;,&quot;country&quot;:&quot;US&quot;,&quot;us_state&quot;:null,&quot;us_zip&quot;:null,&quot;email&quot;:null,&quot;payment_type&quot;:null,&quot;locale&quot;:&quot;en&quot;,&quot;is_default&quot;:true,&quot;country_name&quot;:&quot;United States&quot;}\" data-site=\"{&quot;supportEmail&quot;:&quot;support@gelhc.bandcamp.com&quot;,&quot;is_custom_domain&quot;:null,&quot;env&quot;:&quot;prod&quot;}\" data-band=\"{&quot;id&quot;:3243906099,&quot;name&quot;:&quot;GEL&quot;,&quot;fan_email&quot;:null,&quot;account_id&quot;:874533093,&quot;facebook_like_enabled&quot;:1,&quot;has_discounts&quot;:false,&quot;image_id&quot;:30586232}\" data-embed=\"{&quot;tralbum_param&quot;:{&quot;name&quot;:&quot;album&quot;,&quot;value&quot;:3345834034},&quot;art_id&quot;:2649993152,&quot;artist&quot;:&quot;GEL&quot;,&quot;swf_base_url&quot;:&quot;https://bandcamp.com&quot;,&quot;show_campaign&quot;:null,&quot;embed_info&quot;:{&quot;public_embeddable&quot;:true,&quot;exclusive_embeddable&quot;:false,&quot;item_public&quot;:true,&quot;no_track_preorder&quot;:false},&quot;album_title&quot;:&quot;Persona&quot;,&quot;linkback&quot;:&quot;https://gelhc.bandcamp.com/album/persona&quot;}\" data-fan=\"{&quot;logged_in&quot;:false,&quot;name&quot;:null,&quot;image_id&quot;:null}\" data-band-follow-info=\"{&quot;tralbum_id&quot;:3345834034,&quot;tralbum_type&quot;:&quot;a&quot;}\" data-tralbum-collect-info=\"{&quot;show_collect&quot;:true,&quot;show_wishlist_tooltip&quot;:false}\" data-tralbum=\"{&quot;for the curious&quot;:&quot;https://bandcamp.com/help/audio_basics#steal https://bandcamp.com/terms_of_use&quot;,&quot;current&quot;:{&quot;audit&quot;:5,&quot;title&quot;:&quot;Persona&quot;,&quot;new_date&quot;:&quot;27 Jun 2024 13:23:20 GMT&quot;,&quot;mod_date&quot;:&quot;27 Jun 2024 13:32:28 GMT&quot;,&quot;publish_date&quot;:&quot;27 Jun 2024 13:32:28 GMT&quot;,&quot;private&quot;:null,&quot;killed&quot;:null,&quot;download_pref&quot;:2,&quot;require_email&quot;:null,&quot;is_set_price&quot;:null,&quot;set_price&quot;:7.0,&quot;minimum_price&quot;:7.0,&quot;minimum_price_nonzero&quot;:7.0,&quot;require_email_0&quot;:null,&quot;artist&quot;:null,&quot;about&quot;:null,&quot;credits&quot;:null,&quot;auto_repriced&quot;:null,&quot;new_desc_format&quot;:1,&quot;band_id&quot;:3243906099,&quot;selling_band_id&quot;:4202807880,&quot;art_id&quot;:2649993152,&quot;download_desc_id&quot;:null,&quot;release_date&quot;:&quot;16 Aug 2024 00:00:00 GMT&quot;,&quot;upc&quot;:&quot;198391516337&quot;,&quot;purchase_url&quot;:null,&quot;purchase_title&quot;:null,&quot;featured_track_id&quot;:3857100384,&quot;id&quot;:3345834034,&quot;type&quot;:&quot;album&quot;},&quot;preorder_count&quot;:null,&quot;hasAudio&quot;:true,&quot;art_id&quot;:2649993152,&quot;packages&quot;:null,&quot;defaultPrice&quot;:7.0,&quot;freeDownloadPage&quot;:null,&quot;FREE&quot;:1,&quot;PAID&quot;:2,&quot;artist&quot;:&quot;GEL&quot;,&quot;item_type&quot;:&quot;album&quot;,&quot;id&quot;:3345834034,&quot;last_subscription_item&quot;:null,&quot;has_discounts&quot;:false,&quot;is_bonus&quot;:null,&quot;play_cap_data&quot;:null,&quot;client_id_sig&quot;:null,&quot;is_purchased&quot;:null,&quot;items_purchased&quot;:null,&quot;is_private_stream&quot;:null,&quot;is_band_member&quot;:null,&quot;licensed_version_ids&quot;:null,&quot;package_associated_license_id&quot;:null,&quot;has_video&quot;:null,&quot;tralbum_subscriber_only&quot;:false,&quot;featured_track_id&quot;:3857100384,&quot;initial_track_num&quot;:null,&quot;is_preorder&quot;:true,&quot;album_is_preorder&quot;:true,&quot;album_release_date&quot;:&quot;16 Aug 2024 00:00:00 GMT&quot;,&quot;trackinfo&quot;:[{&quot;id&quot;:null,&quot;track_id&quot;:2956308025,&quot;file&quot;:null,&quot;artist&quot;:null,&quot;title&quot;:&quot;Mirage&quot;,&quot;encodings_id&quot;:1894093668,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:1,&quot;album_preorder&quot;:true,&quot;unreleased_track&quot;:true,&quot;title_link&quot;:null,&quot;has_lyrics&quot;:null,&quot;has_info&quot;:false,&quot;streaming&quot;:null,&quot;is_downloadable&quot;:null,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:0.0,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:null,&quot;is_capped&quot;:null,&quot;track_license_id&quot;:null},{&quot;id&quot;:null,&quot;track_id&quot;:1693071700,&quot;file&quot;:null,&quot;artist&quot;:null,&quot;title&quot;:&quot;Shame&quot;,&quot;encodings_id&quot;:1208469688,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:2,&quot;album_preorder&quot;:true,&quot;unreleased_track&quot;:true,&quot;title_link&quot;:null,&quot;has_lyrics&quot;:null,&quot;has_info&quot;:false,&quot;streaming&quot;:null,&quot;is_downloadable&quot;:null,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:0.0,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:null,&quot;is_capped&quot;:null,&quot;track_license_id&quot;:null},{&quot;id&quot;:3857100384,&quot;track_id&quot;:3857100384,&quot;file&quot;:{&quot;mp3-128&quot;:&quot;https://t4.bcbits.com/stream/3b59645191abd944f62a8e28e21b907e/mp3-128/3857100384?p=0&amp;ts=1720550425&amp;t=d24c6a5b27a4d11530925d990e0b5d86551b694d&amp;token=1720550425_b132db65eab6fb1f569a72d99dcd1bcab47a9af1&quot;},&quot;artist&quot;:null,&quot;title&quot;:&quot;Persona&quot;,&quot;encodings_id&quot;:648387316,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:3,&quot;album_preorder&quot;:true,&quot;unreleased_track&quot;:false,&quot;title_link&quot;:&quot;/track/persona&quot;,&quot;has_lyrics&quot;:true,&quot;has_info&quot;:false,&quot;streaming&quot;:1,&quot;is_downloadable&quot;:true,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:132.24,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:839,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:null,&quot;is_capped&quot;:null,&quot;track_license_id&quot;:null},{&quot;id&quot;:null,&quot;track_id&quot;:159260432,&quot;file&quot;:null,&quot;artist&quot;:null,&quot;title&quot;:&quot;Martyr&quot;,&quot;encodings_id&quot;:267280232,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:4,&quot;album_preorder&quot;:true,&quot;unreleased_track&quot;:true,&quot;title_link&quot;:null,&quot;has_lyrics&quot;:null,&quot;has_info&quot;:false,&quot;streaming&quot;:null,&quot;is_downloadable&quot;:null,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:0.0,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:null,&quot;is_capped&quot;:null,&quot;track_license_id&quot;:null},{&quot;id&quot;:null,&quot;track_id&quot;:2701554402,&quot;file&quot;:null,&quot;artist&quot;:null,&quot;title&quot;:&quot;Vanity&quot;,&quot;encodings_id&quot;:842770910,&quot;license_type&quot;:1,&quot;private&quot;:null,&quot;track_num&quot;:5,&quot;album_preorder&quot;:true,&quot;unreleased_track&quot;:true,&quot;title_link&quot;:null,&quot;has_lyrics&quot;:null,&quot;has_info&quot;:false,&quot;streaming&quot;:null,&quot;is_downloadable&quot;:null,&quot;has_free_download&quot;:null,&quot;free_album_download&quot;:false,&quot;duration&quot;:0.0,&quot;lyrics&quot;:null,&quot;sizeof_lyrics&quot;:0,&quot;is_draft&quot;:false,&quot;video_source_type&quot;:null,&quot;video_source_id&quot;:null,&quot;video_mobile_url&quot;:null,&quot;video_poster_url&quot;:null,&quot;video_id&quot;:null,&quot;video_caption&quot;:null,&quot;video_featured&quot;:null,&quot;alt_link&quot;:null,&quot;encoding_error&quot;:null,&quot;encoding_pending&quot;:null,&quot;play_count&quot;:null,&quot;is_capped&quot;:null,&quot;track_license_id&quot;:null}],&quot;playing_from&quot;:&quot;album page&quot;,&quot;url&quot;:&quot;https://gelhc.bandcamp.com/album/persona&quot;,&quot;use_expando_lyrics&quot;:true}\" data-payment=\"{&quot;paymentType&quot;:null,&quot;paymentDownloadPage&quot;:null}\" data-referrer-token=\"&quot;nilZ0a3345834034x1720464014&quot;\"></script>";
            var customMessageHandler = new TestHttpMessageHandler(document);
            var client = new HttpClient(customMessageHandler);

            var downloader = new BCDownloader(client);
            var resp = await downloader.GetTracksInfoAsync("http://exampleurl.com");
            var tracksCount = 1;

            Assert.NotNull(resp);
            Assert.IsAssignableFrom<IEnumerable<Trackinfo>>(resp);
            Assert.All(resp, item => Assert.NotNull(item.Data));
            Assert.All(resp, item => Assert.Equal("GEL", item.Artist));
            Assert.Equal(tracksCount, resp.Count());
        }
    }
}